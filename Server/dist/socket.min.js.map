{"version":3,"sources":["socket.js"],"names":["_socket","require","socketServer","server","io","Server","cors","origin","methods","on","log","socket","id","data","to","userToCall","emit","console","signalData","from","signal"],"mappings":"2FAAA,IAAAA,QAAAC,QAAA,aAEMC,aAAe,SAACC,GACpB,IAAMC,EAAK,IAAIC,QAAAA,OAAOF,EAAQ,CAC5BG,KAAM,CACJC,OAAQ,IACRC,QAAS,CAAC,MAAO,WAHrBJ,EAAAK,GAAQ,aAAOJ,SAAAA,GACbC,QAAMI,IAAA,yBAAAC,EAAAC,IAEJJ,EAAAA,KAAU,SAAOG,EAARC,IAHbD,EAAAF,GAAA,WAAA,SAAAI,GAOGJ,EAAGK,GAAAD,EAAAE,YAAcC,KAACL,MAAW,CAC9BM,OAAYJ,EAAAK,WAEZP,KAAOK,EAAKG,SAKRA,EAAAA,GAAMN,aAAKM,SAAAA,GAFsBf,EAAnCU,GAAAD,EAAAC,IAAAE,KAAA,eAAAH,EAAAO,UAOAhB,EAAAK,GAAMI,UAAN,SAAoBA,GADtBT,EAGAU,GAAAD,EAAAC,IAAAE,KAAA,eACAL,EAAOF,GAAG,aAAW,WACnBL,QAAMS,IAAKC,qCAjBfZ","file":"socket.min.js","sourcesContent":["import { Server } from \"socket.io\";\r\n\r\nconst socketServer = (server) => {\r\n  const io = new Server(server, {\r\n    cors: {\r\n      origin: \"*\",\r\n      methods: [\"GET\", \"POST\"],\r\n    },\r\n  });\r\n\r\n  io.on(\"connection\", (socket) => {\r\n    console.log(\"New client connected: \", socket.id);\r\n\r\n    socket.emit(\"yourID\", socket.id);\r\n\r\n    socket.on(\"callUser\", (data) => {\r\n      io.to(data.userToCall).emit(\"hey\", {\r\n        signal: data.signalData,\r\n        from: data.from,\r\n      });\r\n    });\r\n\r\n    socket.on(\"acceptCall\", (data) => {\r\n      io.to(data.to).emit(\"callAccepted\", data.signal);\r\n    });\r\n    // Added this to handle endCall event\r\n    socket.on(\"endCall\", (data) => {\r\n      io.to(data.to).emit(\"callEnded\");\r\n    });\r\n    socket.on(\"disconnect\", () => {\r\n      console.log(\"Client disconnected\");\r\n    });\r\n  });\r\n};\r\n\r\nexport default socketServer;\r\n"]}