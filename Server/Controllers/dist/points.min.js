"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.pointsController=void 0;var _mongoose=_interopRequireDefault(require("mongoose")),_Auth=_interopRequireDefault(require("../Models/Auth.js")),_history=_interopRequireDefault(require("../Models/history.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var pointsController=function(t,r){var n,o,s,a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.params.id,o=t.body.viewer,console.log("Request Params:",t.params),console.log("Request Body:",t.body),_mongoose.default.Types.ObjectId.isValid(n)){e.next=6;break}return e.abrupt("return",r.status(404).send("Video Unavailable.."));case 6:return e.prev=6,e.next=9,regeneratorRuntime.awrap(_Auth.default.findById(o));case 9:if(a=e.sent){e.next=12;break}return e.abrupt("return",r.status(404).send("User not found"));case 12:if(a.viewedVideos.some(function(e){return e.equals(n)})){e.next=21;break}return e.next=15,regeneratorRuntime.awrap(_Auth.default.findByIdAndUpdate(o,{$addToSet:{viewedVideos:n}}));case 15:return e.sent,e.next=18,regeneratorRuntime.awrap(_Auth.default.findById(o));case 18:s=e.sent,e.next=22;break;case 21:s=a;case 22:r.status(200).json(s),e.next=28;break;case 25:e.prev=25,e.t0=e.catch(6),r.status(400).json({error:e.t0.message});case 28:case"end":return e.stop()}},null,null,[[6,25]])};exports.pointsController=pointsController;
//# sourceMappingURL=points.min.js.map
