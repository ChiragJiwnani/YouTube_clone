"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getallvideos=exports.uploadvideo=void 0;var _videofile=_interopRequireDefault(require("../Models/videofile.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var uploadvideo=function(t,r){var a;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.file&&["video/mp4"].includes(t.file.mimetype)){e.next=3;break}return r.status(400).json({message:"Please upload a .mp4 video file only."}),e.abrupt("return");case 3:return e.prev=3,a=new _videofile.default({videotitle:t.body.title.trim()||"Untitled",filename:t.file.originalname,filepath:t.file.path,filetype:t.file.mimetype,filesize:t.file.size,videochanel:t.body.chanel.trim()||"Default Channel",uploader:t.body.uploader.trim()||"Anonymous"}),e.next=7,regeneratorRuntime.awrap(a.save());case 7:r.status(201).send("File uploaded successfully"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),e.t0 instanceof mongoose.Error.ValidationError?r.status(400).json({message:"Validation error occurred."}):"MongoError"===e.t0.name&&11e3===e.t0.code?r.status(409).json({message:"Duplicate key error."}):r.status(500).json({message:"An unexpected error occurred."});case 13:case"end":return e.stop()}},null,null,[[3,10]])};exports.uploadvideo=uploadvideo;var getallvideos=function(e,t){var r;return regeneratorRuntime.async(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,regeneratorRuntime.awrap(_videofile.default.find());case 3:r=e.sent,t.status(200).send(r),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t.status(500).json({message:"Failed to retrieve videos."});case 10:case"end":return e.stop()}},null,null,[[0,7]])};exports.getallvideos=getallvideos;
//# sourceMappingURL=video.min.js.map
